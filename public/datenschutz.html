<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Datenschutz</title>
    <link rel="stylesheet" href="src/styles.css">
</head>

<body>
    <header>
        <a class="brand" href="index.html">
            <img src="hottakes_favicons/Hottakes.icon-192x192.png" alt="Hottakes Logo" class="brand-logo">
            <span class="brand-name">Hottakes</span>
        </a>
        <div class="header-actions auth-pending" id="auth-header">
            <a href="login.html" class="btn">Login</a>
            <a href="register.html" class="btn">Register</a>
        </div>
    </header>

    <main class="legal-container">
        <h1>Datenschutzerklärung</h1>
        <h2>Allgemeines</h2>
        <p>Die Nutzung unserer Webseite ist in der Regel ohne Angabe personenbezogener Daten möglich. Soweit auf unseren
            Seiten personenbezogene Daten (beispielsweise Name, Anschrift oder E-Mail-Adressen) erhoben werden, erfolgt
            dies, soweit möglich, stets auf freiwilliger Basis.</p>

        <h2>Cookies</h2>
        <p>Diese Seite verwendet technisch notwendige Cookies ("Session Cookies"), um den Login-Status zu speichern.
            Diese Cookies werden nicht für Werbezwecke genutzt und sind für die Funktion der Anmeldung erforderlich.</p>

        <h2>Server-Log-Files</h2>
        <p>Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log Files, die
            Ihr Browser automatisch an uns übermittelt.</p>

        <p><a href="index.html">Zurück zur Startseite</a></p>
    </main>

    <script>
        (async () => {
            const header = document.getElementById('auth-header');
            if (!header) return;

            try {
                const res = await fetch('/api/auth/me', { credentials: 'include' });
                if (res.ok) {
                    const data = await res.json();
                    if (data && data.user) {
                        header.innerHTML = `
                            <span style="margin-right: 10px; font-weight: bold;">${data.user.nickname}</span>
                            <button id="btn-logout" class="btn">Logout</button>
                        `;
                        const logoutBtn = document.getElementById('btn-logout');
                        if (logoutBtn) {
                            logoutBtn.addEventListener('click', async () => {
                                await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
                                window.location.href = 'index.html';
                            });
                        }
                        header.classList.remove('auth-pending');
                        return;
                    }
                }
            } catch (error) {
                console.warn('Auth check skipped on legal page', error);
            }

            header.innerHTML = `
                <a href="login.html" class="btn">Login</a>
                <a href="register.html" class="btn">Register</a>
            `;
            header.classList.remove('auth-pending');
        })();
    </script>
</body>

</html>